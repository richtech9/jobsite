<?php/** current-php-code 2020-Oct-10* input-sanitized : action,lang,linguist,proposal_id* current-wp-template:  freelancer contest*/global $wpdb;global $post;$lang = FLInput::get('lang', 'en');$action = FLInput::get('action');$proposal_id = FLInput::get('proposal_id');$linguist = FLInput::get('linguist');$post_id = get_the_ID();$current_user = wp_get_current_user();$current_user_id = $current_user->ID;$SiteLang = $lang;$addParticipants = get_post_meta($post_id, 'all_contest_paricipants', true);$curParti = explode(',', $addParticipants);$job_type = get_post_meta($post_id, 'fl_job_type', true);$sql_statement =    "SELECT GROUP_CONCAT(tag_id) as tag_ids FROM wp_tags_cache_job WHERE `job_id` = $post_id AND type = " . FreelinguistTags::CONTEST_TAG_TYPE;$post_tags = $wpdb->get_results($sql_statement);if ($action == "proposals") {    get_template_part('includes/user/single-job/contest', 'translator-proposals');} elseif ($action == "new-proposal") {    get_template_part('includes/user/single-job/contest', 'translator-new-proposal');} elseif (($action == "proposal") && $proposal_id) {    get_template_part('includes/user/single-job/contest', 'translator-proposal');} elseif (($action == "other-translator-proposal") && $proposal_id && $linguist) {    get_template_part('includes/user/single-job/contest', 'other-translator-proposal');} elseif (($action == "winner-proposal") && $proposal_id) {    get_template_part('includes/user/single-job/contest', 'translator-winner-proposal');} else {    ?>    <div class="title-top">        <div class="container">            <i class="icon icon-box"></i>            <p class="large-text">                <?php echo get_post_meta($post_id, 'project_title', true); ?>            </p>        </div>    </div>    <section class="middle-content">        <div class="container" id="container-body">            <div class="dashboard-sec sing-ling job_dtls">                <div class="row">                    <div class="job-details col-md-12" style=" padding-left: 0px;">                        <div class="hire-linguist-top">                            <div class="hire-linguist-top-left">                                <?php                                if (!in_array($current_user_id, $curParti)) {                                    echo '<a id="prt_accept" linguId="' . $current_user_id . '" contestId="' .                                        $post_id . '" lang ="' . $lang . '" class="hirebttn2" href="#">PARTICIPATE</a>';                                } else {                                    ?>                                    <a class="hirebttn2" href="<?= get_permalink() ?>&action=proposals">PROPOSALS</a>                                    <?php                                }                                ?>                            </div>                            <div class="top-btns">                            </div>                            <?php                            //code-notes Show cancelled on freelancer details page                            $b_is_contest_cancelled = get_post_meta($post_id, 'is_cancellation_approved') ? true : false;                            if ($b_is_contest_cancelled) {                                ?>                                <div class="fl-inline-right">                                    <span class="red-btn fl-competition-cancelled-notice enhanced-text">Cancelled</span>                                </div>                                <?php                            }                            ?>                        </div>                    </div>                    <div class="linguist-header">                        <div class="col-33">                            <span class="bold-and-blocking large-text"><?php echo get_the_title($post_id); ?></span>                            <?php                            $delviTime = get_post_meta($post_id, 'job_standard_delivery_date', true);                            $formatDelvi = date("d/m/Y", strtotime($delviTime));                            ?>                            <p class="large-text">Deadline: <?php echo $formatDelvi; ?></p>                            <p class="large-text">Client Self                                    Insurance:<?php echo get_post_meta($post_id, 'is_guaranted', true) == 1 ? 'Yes' : 'No'; ?>                            </p>                        </div>                        <div class="col-33">                            <?php                            $budget = get_post_meta($post_id, 'estimated_budgets', true);                            $arrBudget = explode('_', $budget);                            $from = $arrBudget[0];                            $end = '';                            if (count($arrBudget) > 1) {                                $end = $arrBudget[1];                            }                            if ($end != '') {                                $totalBudget = '$' . $from . ' to ' . '$' . $end;                            } else {                                $totalBudget = '$' . $from;                            }                            ?>                            <p class="large-text">Price: <?php echo $totalBudget; ?></p>                        </div>                        <div class="col-33">                        </div>                    </div><!--#linguist-header-->                    <div class="cs_customer_column">                        <div class="h1-title"><span class="bold-and-blocking larger-text">Instructions</span></div>                        <p>                            <?php echo  get_post_meta($post_id, 'project_description', true); ?>                        </p>                        <div class="h1-title"><span class="bold-and-blocking larger-text">Skills</span></div>                        <?php                        foreach ($post_tags as $k => $v) {                            $post_tags_array = explode(",", $v->tag_ids);                            foreach ($post_tags_array as $v1) {                                if (empty($v1)) {continue;}                                $interest_tags = $wpdb->get_results("SELECT * FROM wp_interest_tags WHERE `id` = $v1");                                foreach ($interest_tags as $k2 => $v2) {                                    $tags_name_array[] = $v2->tag_name;                                }                            }                        }                        if (isset($tags_name_array) && sizeof($tags_name_array) > 0) {                            echo '<p>';                            foreach ($tags_name_array as $key => $value) {                                if ($key == sizeof($tags_name_array) - 1) {                                    echo $value;                                } else {                                    echo $value . ',';                                }                            }                            echo '</p>';                        }                        ?>                        <p>                        </p>                        <div class="instruct-file">                            <span class="bold-and-blocking large-text">Public Instruction Files</span>                            <?php                            $auth_or = $post->post_author;                            //code-notes [contest customer private instructions]  only get the public contest files made by the author of the contest                            $tfiles = $wpdb->get_results("SELECT * FROM wp_files WHERE `post_id` = $post_id AND by_user = $auth_or AND proposal_id IS NULL");                            echo '<div class="attached-doc">';                            if ($tfiles) {                                echo '<ul>';                                foreach ($tfiles as $fl) {                                    ?>                                    <li>                                        <div class="col-md-12">                                            <div class="doc-name">                                                <!-- code-notes [download]  new download line -->                                                <div class="freelinguist-download-line">                                                    <span class="freelinguist-download-name">                                                        <i class="text-doc-icon larger-text"></i>                                                        <span class="freelinguist-download-name-itself enhanced-text">                                                            <?= $fl->file_name ?>                                                        </span>                                                    </span> <!-- /.freelinguist-download-name -->                                                    <a class="red-btn-no-hover freelinguist-download-button enhanced-text"                                                       data-job_file_id = "<?= $fl->id ?>"                                                       download = "<?= $fl->file_name ?>"                                                       href="#">                                                        Download                                                    </a> <!-- /.freelinguist-download-button -->                                                </div><!-- /.freelinguist-download-line-->                                            </div>		    						    </div>									</li>                                    <?php                                }                                echo '</ul>';                            }                            echo '</div>';                            ?>                        </div>                    </div>                    <div class="review-listing comments_lists">                        <div class="title">                            <h3>Public Clarifications</h3>                            <span class=""></span>                        </div>                        <div class="bidding-other" style="width: 100%;">                            <div class="hz_discussion_row">                                <?php                                echo hz_fl_discussion_list_public($post_id); ?>                            </div>                            <div class="text-box">                                <form id="contest_discussion">                                    <textarea required name="comment" placeholder="Write here" autocomplete="off" ></textarea>                                    <input type="hidden" name="post_id" value="<?php echo $post_id; ?>">                                    <input type="hidden" name="comment_to" value="0">                                    <input type="submit" value="Contact Customer" class="enhanced-text">                                </form>                            </div>                        </div>                    </div>                    <!----  Report Button ---------------------->                    <a id="report_button" class="box-prement2 grey fr" href="#" data-toggle="modal"                       data-target="#openCCboxReport"> Report</a>                    <div class="hire-linguist">                        <div class="modal fade" id="openCCboxReport" tabindex="-1" role="dialog"                             aria-labelledby="myModalLabel" aria-hidden="true">                            <div class="modal-dialog">                                <div class="modal-content">                                    <div class="modal-header">                                        <button type="button" class="close huge-text" data-dismiss="modal">&times;                                        </button>                                        <h4 class="modal-title"><?php get_custom_string('Report'); ?></h4>                                    </div>                                    <div class="modal-body">                                        <div class="freelinguist-report-caution">                                            <span class="large-text">Submit a report only if it contains inappropriate content</span>                                        </div>                                        <form id="report_form" method="post">                                            <div class="form-group">                                                <input type="hidden" name="reported_by"                                                       value="<?php echo get_current_user_id(); ?>">                                                <input type="hidden" name="content" value="">                                                <input type="hidden" name="linguist"                                                       value="<?php echo get_current_user_id(); ?>">                                                <input type="hidden" name="project" value="">                                                <input type="hidden" name="contest" value="<?php echo $post_id; ?>">                                                <input type="hidden" name="action" value="hz_submit_report">                                            </div>                                            <div class="form-group">                                                <textarea class="form-control" id="report_note" placeholder="Note"                                                          name="report_note" autocomplete="off" ></textarea>                                            </div>                                            <button type="button" class="btn blue-btn"                                                    onClick="return submit_report();">Submit                                            </button>                                            <div class="freelinguist-after-submit-report">                                                <span class="small-text"></span>                                            </div>                                        </form>                                    </div>                                </div>                            </div>                        </div>                        <!------------------------>                    </div>                </div>            </div>        </div>    </section><?php } ?>